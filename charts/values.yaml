# ═══════════════════════════════════════════════════════════════════════════
# LiveAvatar Agent Helm Chart Values
# Default configuration for the AI Video Avatar
# ═══════════════════════════════════════════════════════════════════════════

global:
  domain: demos.2060.io

# ───────────────────────────────────────────────────────────────────────────
# Application Configuration
# ───────────────────────────────────────────────────────────────────────────
name: liveavatar-agent-app
replicas: 1
containerPort: 4001

image:
  pullPolicy: Always

# ───────────────────────────────────────────────────────────────────────────
# Ingress Configuration
# ───────────────────────────────────────────────────────────────────────────
ingress:
  enabled: true
  className: nginx
  host: "{{ .Values.name }}.{{ .Values.global.domain }}"
  tlsSecret: "public.{{ .Values.name }}.{{ .Values.global.domain }}-cert"
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod

# ───────────────────────────────────────────────────────────────────────────
# Environment Variables
# ───────────────────────────────────────────────────────────────────────────
env:
  # VS Agent connection (internal Kubernetes service)
  vsAgentUrl: 'http://{{ index .Values "vs-agent-chart" "name" }}:3000'
  
  # LiveAvatar API configuration
  liveavatarApiUrl: https://api.liveavatar.com
  liveavatarLanguage: en

# Secrets - these should be set via Kubernetes secrets or CI/CD
secrets:
  # HeyGen LiveAvatar API Keys
  liveavatarApiKey: ""
  liveavatarAvatarId: ""
  liveavatarVoiceId: ""
  liveavatarContextId: ""

# Use existing Kubernetes secret instead of creating one
existingSecret: ""

# ───────────────────────────────────────────────────────────────────────────
# Resource Limits
# ───────────────────────────────────────────────────────────────────────────
resources:
  requests:
    memory: "256Mi"
    cpu: "100m"
  limits:
    memory: "512Mi"
    cpu: "500m"

# ───────────────────────────────────────────────────────────────────────────
# Health Checks
# ───────────────────────────────────────────────────────────────────────────
livenessProbe:
  httpGet:
    path: /health
    port: 4001
  initialDelaySeconds: 30
  periodSeconds: 30
  timeoutSeconds: 10
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /health
    port: 4001
  initialDelaySeconds: 15
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

# ───────────────────────────────────────────────────────────────────────────
# VS Agent Sidecar Configuration
# ───────────────────────────────────────────────────────────────────────────
vs-agent-chart:
  enabled: true
  name: liveavatar-agent-vsa
  
  # DIDComm/Hologram configuration
  didcommLabel: "LiveAvatar Agent"
  eventsBaseUrl: "http://{{ .Values.name }}:4001"
  didcommInvitationImageUrl: "https://raw.githubusercontent.com/2060-io/hologram-liveavatar-agent-vs/main/public/logo.png"
  
  # Ingress for VS Agent (DIDComm endpoint)
  ingress:
    host: "dm.{{ .Values.name }}.{{ .Values.global.domain }}"
    tlsSecret: "public.{{ .Values.name }}.{{ .Values.global.domain }}-cert"
    private:
      whitelistSourceRange: "0.0.0.0/0"
      host: "admin.{{ .Values.name }}.{{ .Values.global.domain }}"
  
  # Extra environment variables for VS Agent
  extraEnv:
    - name: AGENT_WALLET_ID
      value: "LiveAvatarAgent"
    - name: AGENT_WALLET_KEY
      value: "LiveAvatarAgent"
    - name: SELF_ISSUED_VTC_ORG_TYPE
      value: "PRIVATE"
    - name: SELF_ISSUED_VTC_ORG_COUNTRYCODE
      value: "EE"
    - name: SELF_ISSUED_VTC_ORG_ADDRESS
      value: "Ahtri tn 13 10152 Tallinn"
    - name: SELF_ISSUED_VTC_SERVICE_TYPE
      value: "AI Video Avatar"
    - name: SELF_ISSUED_VTC_SERVICE_DESCRIPTION
      value: "Interactive AI-powered video avatar for Hologram"
    - name: SELF_ISSUED_VTC_SERVICE_MINIMUMAGEREQUIRED
      value: "1"
    - name: USE_CORS
      value: "true"
